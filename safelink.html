<!DOCTYPE html>
<html>
<head>
  <style>
    /* CSS for responsiveness */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .primarch {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .banner {
      text-align: center;
      color: #333;
    }

    #cArea {
      margin-top: 20px;
    }

    #cArea input[type="text"],
    #cArea textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      margin-bottom: 10px;
      box-sizing: border-box;
    }

    #advanced {
      display: none;
      margin-top: 10px;
    }

    #advanced label {
      display: block;
      margin-bottom: 5px;
    }

    #create-link {
      display: block;
      width: 100%;
      padding: 10px;
      background-color: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }

    .status {
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f0f0;
      border-radius: 5px;
    }

    #result {
      width: 100%;
      height: 100px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      margin-bottom: 10px;
      box-sizing: border-box;
      resize: none;
    }

    .copy-btn {
      display: inline-block;
      padding: 10px;
      background-color: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      text-decoration: none;
      margin-right: 10px;
      cursor: pointer;
    }

    .outline {
      background-color: transparent;
      color: #4CAF50;
      border: 1px solid #4CAF50;
    }
  </style>
</head>
<body>
  <div class="primarch">
    <h2 class="banner">Primarch Safelink</h2>
    <div id="cArea">
      <div>
        <input id="link-to" type="text" placeholder="Enter your link" />
      </div>
      <!--[Config]-->
      <div id="advanced">
        <label>Input your redirect page link</label>
        <br />
        <input id="link-page" type="text" value="https://tools.gitforge.in/redirect.html" disabled=""/>
      </div>
    </div>

    <div id="">
      <button id="create-link" class="button">Generate</button>
      <div class="status" id="notifi"></div>
    </div>

    <div id="cArea">
      <textarea readonly id="result" style="word-break: break-all" onkeyup="document.getElementById('open').href = this.value || 'javascript:0'"></textarea>
      <div style="display: flex; justify-content: center; align-items: center;">
        <a name="result" class="copy-btn button" href="javascript:()">Copy</a>
        <a id="open" class="copy-btn outline button" target="_blank">Open</a>
      </div>
    </div>
  </div>
    <script>
	function validate() {
		if (document.getElementById("link-to").value.length == 0) {
			return false
		}
		if (document.getElementById("link-page").value.length == 0) {
			return false
		}
		return true
	}

	var notifi = document.getElementById("notifi");
	document.getElementById("create-link").addEventListener("click", () => {
		if (!validate()) {
			document.getElementById("result").value = "";
			notifi.style["animation-name"] = null;
			notifi.offsetHeight;
			notifi.style["animation-name"] = "fail";
			return;
		}
		var linkPage = document.getElementById("link-page").value.trim();
		var linkTo = document.getElementById("link-to").value.trim();
		linkTo = linkTo.replace(/^((?!(\w+:))(\/\/)?)/, "http://"); // auto add http://
		var data = {
			url: linkTo,
		},
			base = btoa(encodeURIComponent(JSON.stringify(data))).replace(/={1,}$/, ""),
			queryVal = "~gitforge" + "=" + base,
			result;
		if (linkPage.indexOf("#") != -1) {
			var urlAndHash = linkPage.split("#", 2);

			if (urlAndHash[0].indexOf("?") != -1) {
				result = urlAndHash[0] + "&" + queryVal + "#" + urlAndHash[1];
			}
			else {
				result = urlAndHash[0] + "?" + queryVal + "#" + urlAndHash[1];
			}

		} else {
			if (linkPage.indexOf("?") != -1) {
				result = linkPage + "&" + queryVal;
			}
			else {
				result = linkPage + "?" + queryVal;
			}
		}

		document.getElementById("result").value = result;
		document.getElementById("open").href = result;
		notifi.style["animation-name"] = null;
		notifi.offsetHeight;
		notifi.style["animation-name"] = "success";
	});

	//@ntdm11 :>
</script>
<script>
	var a = document.getElementsByClassName('copy-btn');
	for (let i = 0; i < a.length; i++) {
		a[i].addEventListener('click', function () {
			var b = a[i].getAttribute("name");
			var text = document.getElementById(b);
			text.select();
			document.execCommand('copy');
		});
	}
</script>
</body>
</html>
